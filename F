#include <stdio.h>
#include <stdlib.h>
#include <string.h>

typedef struct autor
{
    char *nome;
    int publi;
    int *cit;
    int indice;
} autor;

static void merge(autor *v, autor *v1, autor *v2, int size)
{

    int size_v1 = size / 2;
    int size_v2 = size - size_v1;
    int i = 0;
    int j = 0;
    int k = 0;

    /** Enquanto não chegar ao fim da primeira
     *  e da segunda metade **/
    for (i = 0; j < size_v1 && k < size_v2; i++)
    {
        /* Se o elemento da primeira metade
         * é menor ou igual ao da segunda metade,
         * insira-o no vetor resultado
         */
        if (v1[j].indice >= v2[k].indice)
        {
            // v[i] = v1[j++];
            strcpy(v[i].nome, v1[j].nome);
            v[i].indice = v1[j].indice;
            j++;
        }
        /* Caso contrário, insira o elemento da
         * segunda metade no vetor resultado */
        else
        {
            // v[i] = v2[k++];
            strcpy(v[i].nome, v2[k].nome);
            v[i].indice = v2[k].indice;
            k++;
        }
    }

    /** Se ainda  restam elementos na primeira partição **/
    while (j < size_v1)
    {
        /* Copiamos os elementos para o vetor resultado */
        // v[i++] = v1[j++];
        strcpy(v[i].nome, v1[j].nome);
        v[i].indice = v1[j].indice;
        j++;
        i++;
    }
    /** Se ainda  restam elementos na segunda partição **/
    while (k < size_v2)
    {
        /* Copiamos os elementos para o vetor resultado */
        // v[i++] = v2[k++];
        strcpy(v[i].nome, v2[k].nome);
        v[i].indice = v2[k].indice;
        k++;
        i++;
    }
}

void merge_sort(autor *v, int size)
{
    int mid;
    if (size > 1)
    {
        mid = size / 2;
        /* aloca espaço para os subvetores */
        autor *v1 = malloc(sizeof(autor) * mid);
        autor *v2 = malloc(sizeof(autor) * size - mid);
        /* Copia os elementos de v para os subvetores */
        int i;
        for (i = 0; i < mid; i++)
        {
            // v1[i] = v[i];
            v1[i].nome = malloc(30 * sizeof(char));
            strcpy(v1[i].nome, v[i].nome);
            v1[i].indice = v[i].indice;
        }
        for (i = mid; i < size; i++)
        {
            // v2[i - mid] = v[i];
            v2[i - mid].nome = malloc(30 * sizeof(char));
            strcpy(v2[i - mid].nome, v[i].nome);
            v2[i - mid].indice = v[i].indice;
        }
        /* Ordena recursivamente a primeira metade */
        merge_sort(v1, mid);
        /* Ordena recursivamente a segunda metade */
        merge_sort(v2, size - mid);
        /* Faz a junção das duas metades */
        merge(v, v1, v2, size);
        /* Libera o espaço alocado */
        // free(v1);
        // free(v2);
    }
}

void swap(int i, int j, autor *v)
{
    int aux = v[i].cit[j + 1];
    v[i].cit[j + 1] = v[i].cit[j];
    v[i].cit[j] = aux;
}

void bubble_sort(int n, autor *v)
{
    for (int i = 0; i < n; i++)
    {
        int swapped = 1;
        int k;
        for (k = 0; k < v[i].publi - 1 && swapped; k++)
        {
            swapped = 0;
            int j;
            for (j = 0; j < v[i].publi - k - 1; j++)
            {
                if (v[i].cit[j] < v[i].cit[j + 1])
                {
                    swap(i, j, v);
                    swapped = 1;
                }
            }
        }
    }
}

void indice_h(int n, autor *v)
{
    bubble_sort(n, v);
    for (int i = 0; i < n; i++)
    {
        v[i].indice = 0;
        for (int j = 0; j < v[i].publi; j++)
        {
            if ( v[i].cit[j] >= j+1)
            {
                v[i].indice = j+1;
            }
        }
    }
    merge_sort(v,n);
}

int main()
{
    int n;
    scanf("%d", &n);
    autor *v = malloc(n * sizeof(autor));
    for (int i = 0; i < n; i++)
    {
        v[i].nome = malloc(30 * sizeof(char));
        scanf("%s %d", v[i].nome, &v[i].publi);
        v[i].cit = malloc(v[i].publi * sizeof(int));

        for (int j = 0; j < v[i].publi; j++)
        {
            scanf("%d", &v[i].cit[j]);
        }
    }

    indice_h(n, v);
    
    for (int i = 0; i < n; i++)
    {
        printf("%s %d\n", v[i].nome, v[i].indice);
    }
    return 0;
}
